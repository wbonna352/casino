[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Casino",
    "section": "",
    "text": "Projekt symulacji kasyna to projekt portfolio big data, którego celem jest symulacja środowiska kasyna. Prezentuje umiejętności w zakresie systemów rozproszonych, strumieniowania danych i formatów data lake. Projekt wykorzystuje Docker Compose, Apache Kafka, PostgreSQL, Debezium, Spark Structured Streaming oraz MinIO z Apache Iceberg."
  },
  {
    "objectID": "index.html#docker-compose",
    "href": "index.html#docker-compose",
    "title": "Casino",
    "section": "Docker Compose",
    "text": "Docker Compose\nProjekt jest konteneryzowany za pomocą Docker Compose dla łatwego uruchamiania i orkiestracji.\n\nKontenery\n\ncasino-postgres: Kontener z bazą danych PostgreSQL, która jest bazą produkcyjną kasyna.\ncasino-zookeeper: Kontener Apache ZooKeeper, używany do zarządzania koordynacją Kafki.\ncasino-kafka: Kontener Apache Kafka, obsługujący przesyłanie strumieniowych danych między usługami.\ncasino-debezium: Kontener Debezium, służący do rejestrowania zmian w bazie danych PostgreSQL i przesyłania ich do Kafki.\ncasino-curl: Kontener z curl, używany do inicjowania połączenia Debezium z PostgreSQL.\ncasino-init-db: Kontener uruchamiający skrypt w Pythonie, który inicjalizuje bazę danych PostgreSQL.\ncasino-minio: Kontener MinIO, przechowujący dane w formacie Iceberg (obiektowe przechowywanie danych).\ncasino-spark-master: Kontener Spark Master, zarządzający zadaniami obliczeniowymi w klastrze Spark.\ncasino-spark-worker: Kontener Spark Worker, wykonujący zadania obliczeniowe rozdzielane przez Spark Master.\ncasino-spark-players: Kontener Spark do przetwarzania strumieniowych danych związanych z graczami.\ncasino-spark-transactions: Kontener Spark do przetwarzania strumieniowych danych związanych z transakcjami.\ncasino-spark-games: Kontener Spark do przetwarzania strumieniowych danych związanych z grami.\ncasino-user1: Kontener Python dla Gracza 1, symulujący interakcję z grą kasynową.\ncasino-user2: Kontener Python dla Gracza 2, symulujący interakcję z grą kasynową.\ncasino-user3: Kontener Python dla Gracza 3, symulujący interakcję z grą kasynową."
  },
  {
    "objectID": "index.html#flow-danych",
    "href": "index.html#flow-danych",
    "title": "Casino",
    "section": "Flow danych",
    "text": "Flow danych\nDane są generowane przez trzech graczy, którzy wysyłają informacje do bazy danych PostgreSQL. Zmiany w bazie danych są rejestrowane przez Debezium, który następnie przesyła je do systemu Kafka. Z Kafka, dane są odczytywane przez Spark i przetwarzane, a na końcu zapisywane do MinIO w formacie Iceberg.\n\n\n\n\n\ngraph TD\n    A[Player 1] --&gt; D[Postgres]\n    B[Player 2] --&gt; D\n    C[Player 3] --&gt; D\n    D --&gt; |Debezium| E[Kafka]\n    E --&gt; |Spark| F[Minio]"
  },
  {
    "objectID": "index.html#baza-produkcyjna",
    "href": "index.html#baza-produkcyjna",
    "title": "Casino",
    "section": "Baza produkcyjna",
    "text": "Baza produkcyjna\nBaza produkcyjna kasyna jest oparta na PostgreSQL i jest tworzona oraz zarządzana za pomocą SQLAlchemy.\n\nplayersgamestransactions\n\n\n\nSELECT *\nFROM players\n\n\n3 records\n\n\n\n\n\n\n\n\n\n\n\nid\nfirst_name\nlast_name\nemail\naccount_balance\ncreated_at\nupdated_at\n\n\n\n\n3\nOlivia\nBennett\nolivia.bennett@example.com\n0.11\n2024-12-12 19:45:51\n2024-12-13 11:20:09\n\n\n1\nEthan\nClark\nethan.clark@example.com\n631.62\n2024-12-12 19:45:50\n2024-12-13 11:22:32\n\n\n2\nLucas\nHayes\nlucas.hayes@example.com\n680.41\n2024-12-12 19:45:51\n2024-12-13 11:23:24\n\n\n\n\n\n\n\n\nSELECT *\nFROM games\nLIMIT 5\n\n\n5 records\n\n\n\n\n\n\n\n\n\n\n\n\nid\nplayer_id\ntype\nstake\nresult\npayout\ncreated_at\nupdated_at\n\n\n\n\n1\n1\nrange_roulette\n130.0\nwin\n260.0\n2024-12-12 19:46:32\nNA\n\n\n2\n2\nrange_roulette\n220.0\nwin\n440.0\n2024-12-12 19:46:38\nNA\n\n\n3\n2\nrange_roulette\n597.8\nwin\n1195.6\n2024-12-12 19:47:07\nNA\n\n\n4\n1\nrange_roulette\n214.7\nloss\n0.0\n2024-12-12 19:47:03\nNA\n\n\n5\n3\nstraight_roulette\n10.0\nloss\n0.0\n2024-12-12 19:47:39\nNA\n\n\n\n\n\n\n\n\nSELECT *\nFROM transactions\nLIMIT 5\n\n\n5 records\n\n\nid\nplayer_id\ntype\nvalue\ncreated_at\nupdated_at\n\n\n\n\n1\n1\ndeposit\n1000\n2024-12-12 19:45:50\nNA\n\n\n2\n2\ndeposit\n1000\n2024-12-12 19:45:51\nNA\n\n\n3\n3\ndeposit\n1000\n2024-12-12 19:45:51\nNA\n\n\n4\n1\ndeposit\n1000\n2024-12-12 20:33:19\nNA\n\n\n5\n3\ndeposit\n1000\n2024-12-12 20:33:14\nNA"
  },
  {
    "objectID": "index.html#rodzaje-gier",
    "href": "index.html#rodzaje-gier",
    "title": "Casino",
    "section": "Rodzaje gier",
    "text": "Rodzaje gier\n\nStraight Roulette (Ruletka Prosta)\n\nZasady: Gracz stawia zakład na konkretny numer na kole ruletki (numery od 0 do 36).\nMechanizm: Po zakręceniu kołem, losowany jest numer.\n\nWygrana: Gracz wygrywa, jeśli wylosowany numer to 0 (zero).\nPrzegrana: W przeciwnym przypadku gracz przegrywa.\n\nWypłata: Jeśli gracz wygra (numer = 0), wypłata wynosi 36 razy stawka. W przypadku przegranej wypłata wynosi 0.\n\n\n\nRange Roulette (Ruletka Zakresowa)\n\nZasady: Gracz stawia zakład na to, czy wylosowany numer na kole ruletki będzie większy niż 18.\nMechanizm: Po zakręceniu kołem, losowany jest numer.\n\nWygrana: Gracz wygrywa, jeśli wylosowany numer jest większy niż 18 (czyli w zakresie od 19 do 36).\nPrzegrana: Gracz przegrywa, jeśli numer jest w zakresie od 0 do 18.\n\nWypłata: Jeśli gracz wygra (numer &gt; 18), wypłata wynosi 2 razy stawka. W przypadku przegranej wypłata wynosi 0.\n\n\n\nW obu przypadkach:\n\nWynik: Określany jest przez losowanie numeru i porównanie go z odpowiednią wartością lub zakresem.\nPayout (wypłata): Kwota, którą gracz otrzymuje, jeśli wygra, lub 0, jeśli przegra."
  },
  {
    "objectID": "index.html#strategie-graczy",
    "href": "index.html#strategie-graczy",
    "title": "Casino",
    "section": "Strategie Graczy",
    "text": "Strategie Graczy\n\n\n\n\n\n\nNote\n\n\n\nDane graczy użyte w tym projekcie są fikcyjne i zostały stworzone wyłącznie w celach demonstracyjnych.\n\n\n\nEthan Clark\n\nEthan gra w Ruletkę Zakresową (Range Roulette).\nCzas oczekiwania przed każdym zakładem wynosi losowo od 1 do 60 sekund.\nStawka jest obliczana na podstawie salda konta gracza, gdzie stawka to losowa wartość w przedziale od 5% do 50% salda konta, z gwarancją, że stawka nie będzie mniejsza niż 1.\n\n\n\nOlivia Bennett\n\nOlivia gra w Prostą Ruletkę (Straight Roulette).\nCzas oczekiwania przed zakładem wynosi losowo od 1 do 15 sekund.\nStawka jest obliczana na podstawie salda konta gracza, gdzie stawka to losowa wartość w przedziale od 1% do 10% salda konta, z gwarancją, że stawka nie będzie mniejsza niż 1.\n\n\n\nLucas Hayes\n\nLucas gra w jedną z dwóch gier: Prostą Ruletkę (Straight Roulette) lub Ruletkę Zakresową (Range Roulette).\nCzas oczekiwania przed zakładem wynosi losowo od 10 do 60 sekund.\nWybór gry jest losowy. Dla każdej z gier:\n\nJeśli gra w Prostą Ruletkę (Straight Roulette), stawka to losowa wartość w przedziale od 1% do 5% salda konta, z gwarancją, że stawka nie będzie mniejsza niż 1.\nJeśli gra w Ruletkę Zakresową (Range Roulette), stawka to losowa wartość w przedziale od 5% do 50% salda konta, z gwarancją, że stawka nie będzie mniejsza niż 1."
  },
  {
    "objectID": "index.html#struktura-bucketa-minio",
    "href": "index.html#struktura-bucketa-minio",
    "title": "Casino",
    "section": "Struktura Bucketa MinIO",
    "text": "Struktura Bucketa MinIO\nDane kasyna oraz metadane związane z przepływem danych są przechowywane w buckecie MinIO w strukturze przedstawionej poniżej:\ncasino/\n├── checkpoint/\n│   ├── players/\n│   ├── games/\n│   └── transactions/\n├── warehouse/\n│   └── default/\n│       ├── players/\n│       │   ├── data/\n│       │   └── metadata/\n│       ├── games/\n│       │   ├── data/\n│       │   └── metadata/\n│       └── transactions/\n│           ├── data/\n│           └── metadata/\nDane kasyna są najpierw przesyłane do Apache Kafka, gdzie są przechowywane i przetwarzane. Następnie Spark odczytuje te dane z Kafka i przetwarza je. Przetworzone dane są zapisywane do MinIO w formacie Iceberg w katalogu warehouse.\nKatalog checkpoint zawiera dane i metadane związane z etapami przetwarzania danych w Apache Spark. Spark używa katalogu checkpoint, aby przechowywać dane pośrednie, które mogą zostać wykorzystane w przypadku wznowienia procesu przetwarzania.\nKatalog warehouse zawiera finalne dane oraz metadane. Są to dane pochodzące z tabel players, games i transactions, które zostały przetworzone przez Spark i zapisane do MinIO w formacie Iceberg.\nWszystkie dane z kasyna, takie jak wyniki gier, stan konta gracza oraz inne istotne informacje, są przesyłane w polu value.payload.after."
  },
  {
    "objectID": "src/usun.html",
    "href": "src/usun.html",
    "title": "casino",
    "section": "",
    "text": "from casino_spark.main import default_spark\nfrom casino_spark.functions import bigint_to_timestamp\nimport pyspark.sql.functions as F\n\n\nspark = default_spark()\n\n24/12/12 19:46:27 WARN Utils: Your hostname, ubuntu-main resolves to a loopback address: 127.0.1.1; using 192.168.33.10 instead (on interface wlp0s20f3)\n24/12/12 19:46:27 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address\n\n\n:: loading settings :: url = jar:file:/home/wbonna/repos/github/casino/.venv/lib/python3.11/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml\n\n\nIvy Default Cache set to: /home/wbonna/.ivy2/cache\nThe jars for the packages stored in: /home/wbonna/.ivy2/jars\norg.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency\norg.apache.hadoop#hadoop-aws added as a dependency\norg.apache.hadoop#hadoop-client-api added as a dependency\norg.apache.hadoop#hadoop-client-runtime added as a dependency\ncom.amazonaws#aws-java-sdk-bundle added as a dependency\norg.apache.iceberg#iceberg-spark-runtime-3.5_2.13 added as a dependency\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-c7614451-82f9-4a84-84bb-f6a6934bf6cf;1.0\n    confs: [default]\n    found org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.0 in central\n    found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.0 in central\n    found org.apache.kafka#kafka-clients;3.4.1 in central\n    found org.lz4#lz4-java;1.8.0 in central\n    found org.xerial.snappy#snappy-java;1.1.10.3 in central\n    found org.slf4j#slf4j-api;2.0.7 in central\n    found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central\n    found org.apache.hadoop#hadoop-client-api;3.3.4 in central\n    found commons-logging#commons-logging;1.1.3 in central\n    found com.google.code.findbugs#jsr305;3.0.0 in central\n    found org.apache.commons#commons-pool2;2.11.1 in central\n    found org.apache.hadoop#hadoop-aws;3.3.4 in central\n    found com.amazonaws#aws-java-sdk-bundle;1.12.262 in central\n    found org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central\n    found org.apache.iceberg#iceberg-spark-runtime-3.5_2.13;1.4.0 in central\n:: resolution report :: resolve 611ms :: artifacts dl 20ms\n    :: modules in use:\n    com.amazonaws#aws-java-sdk-bundle;1.12.262 from central in [default]\n    com.google.code.findbugs#jsr305;3.0.0 from central in [default]\n    commons-logging#commons-logging;1.1.3 from central in [default]\n    org.apache.commons#commons-pool2;2.11.1 from central in [default]\n    org.apache.hadoop#hadoop-aws;3.3.4 from central in [default]\n    org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]\n    org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]\n    org.apache.iceberg#iceberg-spark-runtime-3.5_2.13;1.4.0 from central in [default]\n    org.apache.kafka#kafka-clients;3.4.1 from central in [default]\n    org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.0 from central in [default]\n    org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.0 from central in [default]\n    org.lz4#lz4-java;1.8.0 from central in [default]\n    org.slf4j#slf4j-api;2.0.7 from central in [default]\n    org.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]\n    org.xerial.snappy#snappy-java;1.1.10.3 from central in [default]\n    ---------------------------------------------------------------------\n    |                  |            modules            ||   artifacts   |\n    |       conf       | number| search|dwnlded|evicted|| number|dwnlded|\n    ---------------------------------------------------------------------\n    |      default     |   15  |   0   |   0   |   0   ||   15  |   0   |\n    ---------------------------------------------------------------------\n:: retrieving :: org.apache.spark#spark-submit-parent-c7614451-82f9-4a84-84bb-f6a6934bf6cf\n    confs: [default]\n    0 artifacts copied, 15 already retrieved (0kB/13ms)\n24/12/12 19:46:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n\n\n\n(\n    spark.read.table(\"players\")\n    .filter(\"offset == 0\")\n    .select(\"value.payload.after.*\")\n).toPandas()\n\n\n\n\n\n\n\n\nid\nfirst_name\nlast_name\nemail\naccount_balance\ncreated_at\nupdated_at\n\n\n\n\n0\n1\nEthan\nClark\nethan.clark@example.com\n0.0\n1734032750722821\nNaN\n\n\n\n\n\n\n\n\nsilver_players = (\n    spark.read.table(\"players\")\n    .select(\n        \"timestamp\",\n        \"value.payload.after.*\"\n    )\n    .withColumn(\"created_at\", bigint_to_timestamp(F.col(\"created_at\")))\n    .withColumn(\"updated_at\", bigint_to_timestamp(F.col(\"updated_at\")))\n)\n\n\n(\n    spark.read.table(\"players\")\n    .select(\n        \"value.payload.after.*\"\n    )\n).toPandas()\n\n\n\n\n\n\n\n\nid\nfirst_name\nlast_name\nemail\naccount_balance\ncreated_at\nupdated_at\n\n\n\n\n0\n1\nOlivia\nBennett\nolivia.bennett@example.com\n696.35\n1734014694645582\n1.734015e+15\n\n\n1\n2\nLucas\nHayes\nlucas.hayes@example.com\n1080.48\n1734014695167237\n1.734015e+15\n\n\n2\n1\nOlivia\nBennett\nolivia.bennett@example.com\n1848.04\n1734014694645582\n1.734015e+15\n\n\n3\n3\nEthan\nClark\nethan.clark@example.com\n693.68\n1734014695388099\n1.734015e+15\n\n\n4\n1\nOlivia\nBennett\nolivia.bennett@example.com\n2909.93\n1734014694645582\n1.734015e+15\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n90\n1\nOlivia\nBennett\nolivia.bennett@example.com\n609.67\n1734014694645582\n1.734015e+15\n\n\n91\n2\nLucas\nHayes\nlucas.hayes@example.com\n1113.90\n1734014695167237\n1.734015e+15\n\n\n92\n1\nOlivia\nBennett\nolivia.bennett@example.com\n2706.23\n1734014694645582\n1.734015e+15\n\n\n93\n3\nEthan\nClark\nethan.clark@example.com\n109.81\n1734014695388099\n1.734015e+15\n\n\n94\n1\nOlivia\nBennett\nolivia.bennett@example.com\n402.41\n1734014694645582\n1.734015e+15\n\n\n\n\n95 rows × 7 columns\n\n\n\n\n(\n    spark\n    .readStream\n    .format(\"iceberg\")\n    .table(\"players\")\n    .select(\n        \"value.payload.after.*\"\n    )\n    .writeStream\n    .outputMode(\"append\")\n    .format(\"console\")\n    .start()\n    .awaitTermination()\n)\n\n24/12/12 14:07:04 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties\n24/12/12 14:07:05 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.\n                                                                                \n\n\n-------------------------------------------\nBatch: 0\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  1|     Ethan|    Clark|ethan.clark@examp...|            0.0|1734010728213444|            NULL|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|            0.0|1734010728317774|            NULL|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|            0.0|1734010729649266|            NULL|\n|  1|     Ethan|    Clark|ethan.clark@examp...|         1000.0|1734010728213444|1734010728217311|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|         1000.0|1734010729649266|1734010729652584|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|          930.0|1734010729649266|1734010755690686|\n|  1|     Ethan|    Clark|ethan.clark@examp...|          710.0|1734010728213444|1734010754254173|\n|  1|     Ethan|    Clark|ethan.clark@examp...|          965.6|1734010728213444|1734010767279528|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         1000.0|1734010728317774|1734010728321185|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          920.0|1734010728317774|1734010787394351|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          883.2|1734010728317774|1734010790410388|\n|  1|     Ethan|    Clark|ethan.clark@examp...|          637.3|1734010728213444|1734010782308872|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|          781.2|1734010729649266|1734010766713364|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         847.87|1734010728317774|1734010799424165|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         830.91|1734010728317774|1734010812448922|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         805.98|1734010728317774|1734010819467250|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         733.44|1734010728317774|1734010823482759|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         667.43|1734010728317774|1734010826496771|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|          390.6|1734010729649266|1734010809764151|\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|         600.69|1734010728317774|1734010833508719|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\nonly showing top 20 rows\n\n-------------------------------------------\nBatch: 1\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          25.77|1734010728317774|1734012418547388|\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|          11.08|1734010729649266|1734012415683523|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 2\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          23.97|1734010728317774|1734012427560026|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 3\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          22.05|1734010728317774|1734012441583653|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 4\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|           6.54|1734010729649266|1734012429707098|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 5\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          20.29|1734010728317774|1734012444595635|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 6\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  1|     Ethan|    Clark|ethan.clark@examp...|           3.62|1734010728213444|1734012415289826|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 7\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|           5.54|1734010729649266|1734012446729071|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 8\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          19.07|1734010728317774|1734012454614946|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 9\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  1|     Ethan|    Clark|ethan.clark@examp...|           2.14|1734010728213444|1734012457341140|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 10\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|           4.54|1734010729649266|1734012461752099|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 11\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          18.07|1734010728317774|1734012468638898|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 12\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          17.07|1734010728317774|1734012482655233|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 13\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          16.07|1734010728317774|1734012483658108|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 14\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          15.07|1734010728317774|1734012494677034|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 15\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|           2.41|1734010729649266|1734012473772954|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 16\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          14.07|1734010728317774|1734012502692845|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 17\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  2|    Olivia|  Bennett|olivia.bennett@ex...|          13.07|1734010728317774|1734012510702755|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n-------------------------------------------\nBatch: 18\n-------------------------------------------\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n| id|first_name|last_name|               email|account_balance|      created_at|      updated_at|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n|  3|     Lucas|    Hayes|lucas.hayes@examp...|           3.41|1734010729649266|1734012507815074|\n+---+----------+---------+--------------------+---------------+----------------+----------------+\n\n\n\nERROR:root:KeyboardInterrupt while sending command.\nTraceback (most recent call last):\n  File \"/home/wbonna/repos/github/casino/.venv/lib/python3.11/site-packages/py4j/java_gateway.py\", line 1038, in send_command\n    response = connection.send_command(command)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/wbonna/repos/github/casino/.venv/lib/python3.11/site-packages/py4j/clientserver.py\", line 511, in send_command\n    answer = smart_decode(self.stream.readline()[:-1])\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.11/socket.py\", line 718, in readinto\n    return self._sock.recv_into(b)\n           ^^^^^^^^^^^^^^^^^^^^^^^\nKeyboardInterrupt\n\n\n\n---------------------------------------------------------------------------\nKeyboardInterrupt                         Traceback (most recent call last)\nCell In[3], line 13\n      1 (\n      2     spark\n      3     .readStream\n      4     .format(\"iceberg\")\n      5     .table(\"players\")\n      6     .select(\n      7         \"value.payload.after.*\"\n      8     )\n      9     .writeStream\n     10     .outputMode(\"append\")\n     11     .format(\"console\")\n     12     .start()\n---&gt; 13     .awaitTermination()\n     14 )\n\nFile ~/repos/github/casino/.venv/lib/python3.11/site-packages/pyspark/sql/streaming/query.py:221, in StreamingQuery.awaitTermination(self, timeout)\n    219     return self._jsq.awaitTermination(int(timeout * 1000))\n    220 else:\n--&gt; 221     return self._jsq.awaitTermination()\n\nFile ~/repos/github/casino/.venv/lib/python3.11/site-packages/py4j/java_gateway.py:1321, in JavaMember.__call__(self, *args)\n   1314 args_command, temp_args = self._build_args(*args)\n   1316 command = proto.CALL_COMMAND_NAME +\\\n   1317     self.command_header +\\\n   1318     args_command +\\\n   1319     proto.END_COMMAND_PART\n-&gt; 1321 answer = self.gateway_client.send_command(command)\n   1322 return_value = get_return_value(\n   1323     answer, self.gateway_client, self.target_id, self.name)\n   1325 for temp_arg in temp_args:\n\nFile ~/repos/github/casino/.venv/lib/python3.11/site-packages/py4j/java_gateway.py:1038, in GatewayClient.send_command(self, command, retry, binary)\n   1036 connection = self._get_connection()\n   1037 try:\n-&gt; 1038     response = connection.send_command(command)\n   1039     if binary:\n   1040         return response, self._create_connection_guard(connection)\n\nFile ~/repos/github/casino/.venv/lib/python3.11/site-packages/py4j/clientserver.py:511, in ClientServerConnection.send_command(self, command)\n    509 try:\n    510     while True:\n--&gt; 511         answer = smart_decode(self.stream.readline()[:-1])\n    512         logger.debug(\"Answer received: {0}\".format(answer))\n    513         # Happens when a the other end is dead. There might be an empty\n    514         # answer before the socket raises an error.\n\nFile /usr/lib/python3.11/socket.py:718, in SocketIO.readinto(self, b)\n    716 while True:\n    717     try:\n--&gt; 718         return self._sock.recv_into(b)\n    719     except timeout:\n    720         self._timeout_occurred = True\n\nKeyboardInterrupt: \n\n\n\n\ndf = silver_players.toPandas()\n\n\ndf\n\n\n\n\n\n\n\n\ntimestamp\nid\nfirst_name\nlast_name\nemail\naccount_balance\ncreated_at\nupdated_at\n\n\n\n\n0\n2024-12-12 14:53:46.462\n3\nEthan\nClark\nethan.clark@example.com\n121.30\n2024-12-12 14:44:55.388099\n2024-12-12 14:53:25.028982\n\n\n1\n2024-12-12 14:49:07.905\n1\nOlivia\nBennett\nolivia.bennett@example.com\n696.35\n2024-12-12 14:44:54.645582\n2024-12-12 14:48:55.174373\n\n\n2\n2024-12-12 14:54:46.583\n3\nEthan\nClark\nethan.clark@example.com\n171.03\n2024-12-12 14:44:55.388099\n2024-12-12 14:53:46.058203\n\n\n3\n2024-12-12 14:50:55.119\n1\nOlivia\nBennett\nolivia.bennett@example.com\n423.32\n2024-12-12 14:44:54.645582\n2024-12-12 14:50:45.384271\n\n\n4\n2024-12-12 14:51:02.133\n1\nOlivia\nBennett\nolivia.bennett@example.com\n410.62\n2024-12-12 14:44:54.645582\n2024-12-12 14:50:54.395745\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n105\n2024-12-12 14:51:55.239\n3\nEthan\nClark\nethan.clark@example.com\n109.81\n2024-12-12 14:44:55.388099\n2024-12-12 14:51:11.872173\n\n\n106\n2024-12-12 14:52:17.283\n2\nLucas\nHayes\nlucas.hayes@example.com\n617.64\n2024-12-12 14:44:55.167237\n2024-12-12 14:51:58.690301\n\n\n107\n2024-12-12 14:49:22.935\n1\nOlivia\nBennett\nolivia.bennett@example.com\n609.67\n2024-12-12 14:44:54.645582\n2024-12-12 14:49:19.217219\n\n\n108\n2024-12-12 14:49:22.935\n2\nLucas\nHayes\nlucas.hayes@example.com\n1113.90\n2024-12-12 14:44:55.167237\n2024-12-12 14:49:02.473037\n\n\n109\n2024-12-12 14:46:16.560\n1\nOlivia\nBennett\nolivia.bennett@example.com\n2706.23\n2024-12-12 14:44:54.645582\n2024-12-12 14:46:06.791723\n\n\n\n\n110 rows × 8 columns\n\n\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\nfig, ax = plt.subplots(figsize=(24, 9))\n\nsns.lineplot(\n    data=df,\n    x=\"updated_at\",\n    y=\"account_balance\",\n    ax=ax,\n    hue=\"id\"\n)\n\nplt.show()\n\n\n\n\n\n\n\n\n\nimport pandas as pd\n\n\ndf = pd.read_parquet(\"~/Downloads/12-12-2024-19-36-46_files_list\")\n\n\ndf.offset\n\n0        0\n1        1\n2        2\n3        3\n4        4\n      ... \n519    106\n520    107\n521    108\n522    109\n523    110\nName: offset, Length: 524, dtype: int64\n\n\n\nx.get(\"payload\").get(\"after\").get(\"updated_at\")\n\n1734027358609274"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Casino Report",
    "section": "",
    "text": "Raport jakiś tam\n\n\n:: loading settings :: url = jar:file:/home/wbonna/repos/github/casino/.venv/lib/python3.11/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplayer_id\n\n\n\nfirst_name\n\n\n\nlast_name\n\n\n\nemail\n\n\n\ndeposit\n\n\n\ngames\n\n\n\nstakes\n\n\n\npayouts\n\n\n\nresult\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n\nEthan\n\n\n\nClark\n\n\n\nethan.clark@example.com\n\n\n\n3000.0\n\n\n\n223\n\n\n\n32011.10\n\n\n\n30190.27\n\n\n\n-1820.83\n\n\n\n\n\n\n\n2\n\n\n\nLucas\n\n\n\nHayes\n\n\n\nlucas.hayes@example.com\n\n\n\nNaN\n\n\n\n220\n\n\n\n81328.87\n\n\n\n73473.52\n\n\n\n-7855.35\n\n\n\n\n\n\n\n3\n\n\n\nOlivia\n\n\n\nBennett\n\n\n\nolivia.bennett@example.com\n\n\n\n4000.0\n\n\n\n564\n\n\n\n10945.33\n\n\n\n8034.42\n\n\n\n-2910.91\n\n\n\n\n\n\n\n\n\n\nPlayers\nTutaj jakieś info czy coś\n\nPlayer 1Player 2Player 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplayer_id\n\n\n\nfirst_name\n\n\n\nlast_name\n\n\n\nemail\n\n\n\ndeposit\n\n\n\ngames\n\n\n\nstakes\n\n\n\npayouts\n\n\n\nresult\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n\nEthan\n\n\n\nClark\n\n\n\nethan.clark@example.com\n\n\n\n2000.0\n\n\n\n166\n\n\n\n20386.23\n\n\n\n18366.21\n\n\n\n-2020.02\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplayer_id\n\n\n\nfirst_name\n\n\n\nlast_name\n\n\n\nemail\n\n\n\ndeposit\n\n\n\ngames\n\n\n\nstakes\n\n\n\npayouts\n\n\n\nresult\n\n\n\n\n\n\n\n\n\n\n\n2\n\n\n\nLucas\n\n\n\nHayes\n\n\n\nlucas.hayes@example.com\n\n\n\nNaN\n\n\n\n173\n\n\n\n68893.55\n\n\n\n62884.01\n\n\n\n-6009.54\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplayer_id\n\n\n\nfirst_name\n\n\n\nlast_name\n\n\n\nemail\n\n\n\ndeposit\n\n\n\ngames\n\n\n\nstakes\n\n\n\npayouts\n\n\n\nresult\n\n\n\n\n\n\n\n\n\n\n\n3\n\n\n\nOlivia\n\n\n\nBennett\n\n\n\nolivia.bennett@example.com\n\n\n\n3000.0\n\n\n\n476\n\n\n\n9582.17\n\n\n\n5096.53\n\n\n\n-4485.64"
  }
]